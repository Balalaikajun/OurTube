# OurTube.backend. Рефлексия и подведение итогов

## Введение

Далее мы постараемся подвести итоги, а так же рассказать о принятых решениях, недоработках и прочем интересном
касательно разработки серверной части видеохостинга.

Подробнее про техническую составляющую проекта можете узнать по [ссылке](backend.md).

### Предисловие

На момент старта разработки обпыт работы с C# был около полутора лет, на ASP.NET порядка пары месяцев.

В качестве темы проекта хотелось взять что-то обладающее относительно простым доменом, но при этом способное разрастись
до высоконагруженной системы, для того чтобы во время разработки концентрироваться в первую очередь на технической
составляющей, а не особенностях бизнеса.

Изначально в качестве темы было желание взять базовый банкинг, но преподавателем была предложена тема видеохостинга,
которая всем показалась более интересной и показательной.

Если не учитывать перерыв в два месяца во время разработки, то в общем на разработку проекта было потрачено порядка 6
месяцев. И к концу разработки, основной целью стало завершение проекта, в формате MVP, из-за чего некоторые моменты
могут проседать по качеству.

## Решения, реализации и интересные моменты

### Архитектура решения

На момент старта разработки знания были очень сильно ограничены. Было желание с самого начала попробовать реализовать
микросервисы, но после недолгих раздумий было принято решение выбрать монолитную архитектуру на время MVP, которое
впоследствии просто прижилось.

Архитектура же решения делалась во многом по наитию и на основе какого то объёма неструктурированной информации. В
следствии некоторых доработок мы пришли к варианту чистой архитектуры в котором приложение разделено на проекты,
согласно слоям.

Данный вариант архитектуры смог хорошо себя показать на мелко-среднем проекте, закрывая все потребности на протяжении
разработки.

### Использование элементов DDD и событий

В приложении выделен доменный слой, в начале разработки он представлял из себя просто набор моделей, которые
конфигурировались через атрибуты, и дублировали некоторые моменты.

Где-то в середине разработки возникла проблема с обработкой связанной логик, касающейся нескольких элементов. Для
решения данной проблемы было принято внедрить доменные события там где возникали таки проблемы с логикой, вследствие
чего в домене появилась первая базовая модель.

Уже ближе к концу разработки, после как появился опыт работы над реальными проектами, для решения ряда проблем было
принято решение пересобрать домен, что повлекло за собой ряд изменений:

- Базовая модель была доработана
    - Был введён Guid в качестве идентификатора
    - Был введён базовый вариант SoftDelete
    - Появились стандартные поля для аудита
- Базовая модель была применена ко всему домену, что позволило использовать более продвинутые техники

В общем элементы DDD показали себя отлично, смогли сделать код значительно чище и понятнее.

Но стоит отметить нынешний реализации есть много пробелов, да как минимум на все сущности существует одна база, что
местами избыточно.

### ASP.Identity

В проекте была использована библиотека ASP.Identity - встроенная система авторизации и аутентификации Microsoft.

Объяснить весь опыт работы с данной библиотекой можно простой фразой: хотел рыбу, а дали удочку.

С самого начала бибиотека воспринималась как готовое решение, которое можно прикрутить парой команд, но вместо этого она
предоставляет набор инструментов с помощью которой можно достаточно просто реализовать хорошую identity.

К сожалению, в рамках проекта так и не дошли руки до нормального её использования, из-за чего проект даже не требует
обязательного подтверждения почты для работы аккаунта, но при этому существует возможность восстановить пароль.

### Рекомендации

Реализация системы рекомендаций стала одним из двух камней преткновения в данном проекте. Ведь как бы не было печально
признавать, но для видеохостинга они являются основой.

Полноценная работа над ней начиналась во второй половине разработки. Было принято идти по самому простому варианту и
сделать алгоритм, основанный на простой выборке лишь бы работал.

Итоговое решение работает за счёт комбинации нескольких более мелких выборок, работающих за счёт подсчёта весов для
видео, и последующим кешированием на стороне сервера, для избежания повторения. Свою задачу закрывает и того достаточно.

### Обработка видео

### UnitOfWork над ORM

### Requests/Replies и проброс сообщений меж слоёв

### Развёртывание

## Недоработки

### Валидация и обработка ошибок

### Модерация

### Тестирование

## Возможные улучшения

### Переход на асихронную обработку видео

### Добавление роли админа и соответствующего функционала

### Теоритический переход на микросервисную архитектуру

## В случае продолжения разработки

## Итоги