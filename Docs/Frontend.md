# OurTube.frontend
## Введение
Этот документ описывает клиентскую часть приложения-видеохостинга OurTube.

### Цель документа
* Дать общее представление о структуре и архитектуре фронтенда.
* Описать ключевые компоненты, страницы и их взаимодействие.
* Определить моменты реализации, которые могут быть пересмотрены и улучшены.
### Основные особенности
* **SPA (Single Page Application)** – динамическое обновление контента без перезагрузки страницы.
* **Адаптивный UI** – поддержка мобильных устройств и разных разрешений экрана.
* **Использование стейт-менеджеров** - функционал, что требует поддержания целостности и согласованности состояний, реализуется через Pinia или localStorage.

### Технологический стек
* Фреймворк: Vue.js 3 Composition API
* Язык: JavaScript
* Управление состояние: Pinia
* Сборка: Vite

## Архитектура и дизайн
### Структура сайта
Composition API позволяет разбить элементы интерфейса на по назначению, с последующим их использованием в разных контекстах. Компоненты разделены на два типа: страничные и отдельные.

**Страничные компоненты**
* Контейнеры для группировки UI-компонентов
* Соответствуют отдельным маршрутам приложения
* Управляют бизнес-логикой страницы

<table>
    <thead>
        <tr>
            <th>Компонент</th><th>Назначение</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>App</td><td>Компонент, что реализует одностраничное приложение, с навигацией по страницам приложения.</td>
        </tr>
        <tr>
            <td>RegPage</td><td>Страница регистрации учётной записи пользователя.</td>
        </tr>
        <tr>
            <td>AuthPage</td><td>Страница авторизации пользователя под своей учётной записью.</td>
        </tr>
        <tr>
            <td>FogPassPage</td><td>Страница ввода данных для восстановления пароля.</td>
        </tr>
        <tr>
            <td>ResetPasswordPage</td><td>Страница восстановления пароля.</td>
        </tr>
        <tr>
            <td>MainPage</td><td>Главная страница сайта, содержит основной блок рекомендаций из блоков видео.</td>
        </tr>
        <tr>
            <td>VideoPage</td><td>Шаблон представляющий видео и функционал связанный с ним, позволяет просматривать рекомендации.</td>
        </tr>
        <tr>
            <td>SearchResultPage</td><td>Отображает результаты поиска по запросу пользователя в поисковой строке.</td>
        </tr>
        <tr>
            <td>PlaylistPage</td><td>Представляет собой список видео под общим плейлистом. Позволяет удалять конкретные видео из данного плейлиста.</td>
        </tr>
        <tr>
            <td>HistoryPage</td><td>Представляет историю просмотра пользователя. Функционал по удалению всей истории, конкретного видео из истории и поиск по истории просмотра.</td>
        </tr>
    </tbody>
</table>


**Отдельные компоненты**
* Независимые элементы интерфейса
* Решают одну конкретную задачу
* Могут комбинироваться между собой
* Отображение зависит от контекста использования

<table>
    <thead>
        <tr>
            <th>Компонент</th><th>Назначение</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>AccountModal</td><td>Модальное окно для изменения аватара и псевдонима.</td>
        </tr>
        <tr>
            <td>CommentsBlock</td><td>Блок комментария. Представляет его метаданные и функционал взаимодействия.</td>
        </tr>
        <tr>
            <td>CommentsPresentation</td><td>Обёртка для CommentsBlock. Обрабатывает действия пользователя с комментариями.</td>
        </tr>
        <tr>
            <td>CreateCommentBlock</td><td>Блок для создания комментария под видео или другим комментарием.</td>
        </tr>
        <tr>
            <td>KebabButton</td><td>Кнопка для открытия различных меню взаимодействия: CommentMenu, KebubMenu</td>
        </tr>
        <tr>
            <td>CommentMenu</td><td>Меню для взаимодействия пользователя со своими комментариями.</td>
        </tr>
        <tr>
            <td>KebubMenu</td><td>Меню для взаимодействия пользователя с видео и плейлистами: ShareOverlay, PlaylistOverlay.</td>
        </tr>
        <tr>
            <td>ShareOverlay</td><td>Оверлей для копирования ссылки на контента: видео или плейлист.</td>
        </tr>
        <tr>
            <td>RetitlePlaylistOverlay</td><td>Оверлей для переименования плейлиста.</td>
        </tr>
        <tr>
            <td>PlaylistCard</td><td>Карточка плейлиста, отображает краткие метаданные плейлиста.</td>
        </tr>
        <tr>
            <td>PlaylistsOverlay</td><td>Оверлей отображающий плейлисты пользователя.</td>
        </tr>
        <tr>
            <td>PlaylistStroke</td><td>Строка, представляющая плейлист. Имеет маркер, что отображает наличие текущего просматриваемого видео в плейлисте.</td>
        </tr>
        <tr>
            <td>ConfirmPannel</td><td>Модальное окно для подтверждения действий пользователя.</td>
        </tr>
        <tr>
            <td>LoadingState</td><td>Элемент интерфейса, отображающий состояние загрузки контента.</td>
        </tr>
        <tr>
            <td>MasterHead</td><td>Функциональный блок для поиска видео, создания видео и взаимодействия с учётной записью.</td>
        </tr>
        <tr>
            <td>MainMenu</td><td>Меню навигации по контенту сайта.</td>
        </tr>
    </tbody>
</table>

Контент и функционал распределён по страницам семантически.

### Навигация по сайту
Приложение реализует принцип одностраничного приложения, навигация меж которыми осуществляется через Vue Router. Текущая страница определяется через url-адрес, что позволяет легко масштабировать приложение.

## Развёртывание

## Итоги
Весь функционал, что был заявлен в техническом задании - реализован.

Интерфейс приложения выполнен согласно макету.

В ходе разработки был получен опыт использования технологий: Vue Router, SPA, Composition Api, Pinia (State Manager), Axios.
### Интересные моменты
Компонент VideoPresentation, реализованный с использованием Composition API, демонстрирует высокий уровень абстракции. Он применяется в различных контекстах:
* рекомендации - MainPage, VideoPage
* плейлисты - PlaylistPage
* результаты поиска - SearchResultPage
* история просмотров - HistoryPage

VideoPresentation — это обёртка для VideoCard, которая задаёт варианты использования и добавляет общие интерфейсы взаимодействия: ShareOverlay и KebabMenu, избавляя от необходимости дублировать их в каждом VideoCard.

### Недоработки
* При удалении видео из истории просмотров или плейлиста можно добавить отложенный запрос с возможностью отмены. Это улучшит UX и снизит количество случайных удалений.
* Отсутствует единый интерфейс работы с комментариями. Сейчас каждый CommentBlock использует свой CommentMenu, вместо общего управления через CommentsPresentation.
* Нет страницы канала (агрегации загруженного контента).
* Сбои в подсчёте просмотров.
* Удаление из истории/плейлистов требует перезагрузки.
* Сервер располагает функционалом для сохранения прогресса просмотра видео при переходе на него со страницы истории просмотра, но данная возможность не реализована приложением.
### Улучшения
* Создать единый источник истины для адаптивного дизайна, заменив разрозненные медиазапросы в компонентах на общий менеджер конфигураций.
* Устранить 'немое' падение запросов контента через внедрение системы обработки ошибок с трекингом статусов и recovery-стратегиями.
* При смене качества видео проиходит подёргивание, необходимо пересмотреть алгоритм подгрузки на более оптимизированный.
### План в случае продолжения разработки
1. Провести аудит UI/UX под руководством дизайнера.
2. Сделать стили более единообразными. В идеале - переработать именования стилей и структуру DOM согласно методологии БЭМ.
3. Реализовать единый истойник истины для адаптивного дизайна.
4. Пересмотреть алгоритм подсчёта просмотров.
5. Реализовать продолжение просмотра с заданной точки при переходе на видео из истории просмотра.
6. Реализовать обновление содержимого страницы при взаимодействии с контентом: комментировании, удалении записей из истории просмотра или плейлиста.
7. Пересмотреть архитектуру отношений CommentMenu, CommentsPresentation и CommentBlock в сторону единого CommentMenu для всех элементов DOM вида CommentBlock.
8. Реализовать интерфейс взаимодействия пользователя с загруженным им контентом.
9. Реализовать ограниченное по числу попыток автоматическое повторение запросов при сбое или неудачных запросах. Если ответ так и не получен, предоставлять пользователю кнопку для ручного повторного запроса. При потере соединения, создавать очередь запросов для отправки после восстановления соединения.
10. Обновить алгоритм смены качества.